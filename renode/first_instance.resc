:name: STM32F4 Discovery
:description: This script runs MicroROS test on STM32F4 Discovery.

using sysbus
$name?="STM32F4_Discovery"
mach create $name
machine LoadPlatformDescription $ORIGIN/stm32f4_discovery-kit.repl
cpu PerformanceInMips 125
emulation CreateUartPtyTerminal "term0" $ORIGIN/uart
showAnalyzer sysbus.uart2
showAnalyzer sysbus.uart1
connector Connect sysbus.uart1 term0
macro reset
"""
    sysbus LoadELF $ORIGIN/zephyr.elf
"""
runMacro $reset

